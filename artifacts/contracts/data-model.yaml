entities:
  Task:
    description: A unit of work to be tracked
    storage: "sync.RWMutex + map[string]Task (keyed by ID)"
    fields:
      - name: id
        type: string
        format: uuid
        description: >
          Unique identifier, generated server-side via crypto/rand.
          newUUID() returns (string, error) — propagates rand.Read failures.
      - name: title
        type: string
        constraints: "required, 1-255 chars"
        description: Short summary of the task
      - name: description
        type: string
        constraints: "optional, max 4096 chars"
        description: Detailed description of the task
      - name: status
        type: string
        enum: [todo, in_progress, done]
        default: todo
        description: Current state of the task
      - name: created_at
        type: time.Time
        format: RFC3339
        description: Timestamp when the task was created (server-set, UTC)
      - name: updated_at
        type: time.Time
        format: RFC3339
        description: Timestamp of last modification (server-set, UTC)

    relationships: []

    notes:
      - "newUUID() returns (string, error) — propagates crypto/rand.Read failures"
      - "Store.Create returns (Task, error) to propagate UUID generation failures"
      - "All timestamps are set server-side in UTC, never accepted from client"
      - "On create, status defaults to 'todo' — client cannot set status on creation"
      - "On update, only provided fields are modified (partial update via pointer fields)"
      - "Store.All returns tasks sorted by created_at ascending for deterministic output"

    types:
      UpdateFields:
        description: Optional fields for partial task updates (pointer-based nil semantics)
        fields:
          - name: Title
            type: "*string"
            json: title
          - name: Description
            type: "*string"
            json: description
          - name: Status
            type: "*string"
            json: status

      validStatuses:
        description: "O(1) lookup map for status validation"
        type: "map[string]bool"
        values: { todo: true, in_progress: true, done: true }
